<nav class="nav">
  <div class="nav-left">
    <a href="{{ site.baseurl }}/">
      <svg width="32" height="32" viewBox="0 0 32 32" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
        <rect x="8" y="8" width="16" height="16" rx="4" />
      </svg>
    </a>
  </div>

  {%- if site.preferences.search.enabled -%}
  <div class="nav-search">
    <div class="search-container">
      <input class="search-input" type="text" placeholder="Search..." id="search-input" autocomplete="off">
      <div id="search-results" class="search-results"></div>
    </div>
  </div>
  {%- endif -%}

  <div class="nav-right">
    <button class="theme-toggle" aria-label="Toggle dark mode" title="Toggle dark mode">
      <!-- Moon icon (shown in light mode) -->
      <svg class="icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
      </svg>
      <!-- Sun icon (shown in dark mode) -->
      <svg class="icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="5"/>
        <line x1="12" y1="1" x2="12" y2="3"/>
        <line x1="12" y1="21" x2="12" y2="23"/>
        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
        <line x1="1" y1="12" x2="3" y2="12"/>
        <line x1="21" y1="12" x2="23" y2="12"/>
        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
      </svg>
    </button>
    <div class="dropdown">
      <div class="hamburger">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M3 6H21M3 12H21M3 18H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
      <div class="dropdown-menu">
        {%- if site.menu -%}
          {%- for item in site.menu -%}
            <a href="{{ site.baseurl }}{{ item.url }}">{{ item.title }}</a>
          {%- endfor -%}
        {%- else -%}
          <a href="{{ site.baseurl }}/">About</a>
          <a href="{{ site.baseurl }}/notes">Notes</a>
          <a href="{{ site.baseurl }}/about">About</a>
        {%- endif -%}
      </div>
    </div>
  </div>
</nav>

{%- if site.preferences.search.enabled -%}
<script type="text/javascript" src="{{ site.baseurl }}/assets/js/vendor/lunr.min.js"></script>
<script src="{{ site.baseurl }}/assets/js/Search.js"></script>
{%- endif -%}

<script>
  const hamburger = document.querySelector('.hamburger');
  const dropdown = document.querySelector('.dropdown');

  hamburger.addEventListener('click', function(e) {
    e.stopPropagation();
    this.classList.toggle('active');
    dropdown.classList.toggle('active');
  });

  document.addEventListener('click', function(e) {
    if (!e.target.closest('.dropdown')) {
      hamburger.classList.remove('active');
      dropdown.classList.remove('active');
    }
  });

  // Theme toggle
  const themeToggle = document.querySelector('.theme-toggle');
  const root = document.documentElement;
  const body = document.body;

  function setTheme(theme) {
    root.setAttribute('data-theme', theme);
    localStorage.setItem('theme', theme);
  }

  // Initial theme from localStorage
  const savedTheme = localStorage.getItem('theme');
  if (savedTheme) {
    setTheme(savedTheme);
  }

  themeToggle.addEventListener('click', function() {
    root.classList.add('theme-transition');
    body.classList.add('theme-transition');

    const isDark = root.getAttribute('data-theme') === 'dark';
    setTheme(isDark ? 'light' : 'dark');
  });
</script>
